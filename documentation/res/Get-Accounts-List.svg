<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1418px" preserveAspectRatio="none" style="width:752px;height:1418px;" version="1.1" viewBox="0 0 752 1418" width="752px" zoomAndPan="magnify"><defs><filter height="300%" id="f4ylvyktbu14i" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#ADD8E6" height="1403.875" style="stroke: #A80036; stroke-width: 1.0;" width="131" x="208.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="81" x="233.5" y="16.5684">Account API</text><rect fill="#90EE90" height="1403.875" style="stroke: #A80036; stroke-width: 1.0;" width="285.5" x="439.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="539.75" y="16.5684">Microservice</text><rect fill="#FFFFFF" filter="url(#f4ylvyktbu14i)" height="876.6875" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="269" y="96.4883"/><rect fill="#FFFFFF" filter="url(#f4ylvyktbu14i)" height="96.6211" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="514" y="414.791"/><rect fill="#FFFFFF" filter="url(#f4ylvyktbu14i)" height="565.8281" style="stroke: #000000; stroke-width: 2.0;" width="574" x="167" y="352.0371"/><rect fill="#FFFFFF" filter="url(#f4ylvyktbu14i)" height="534.5176" style="stroke: #000000; stroke-width: 2.0;" width="554" x="177" y="376.3477"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="45" x2="45" y1="86.4883" y2="1321.3867"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="273.5" x2="273.5" y1="86.4883" y2="1321.3867"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="518.5" x2="518.5" y1="86.4883" y2="1321.3867"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="682" x2="682" y1="86.4883" y2="1321.3867"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="22" y="83.5352">Client</text><ellipse cx="45" cy="13" fill="#FEFECE" filter="url(#f4ylvyktbu14i)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M45,21 L45,48 M32,29 L58,29 M45,48 L32,63 M45,48 L58,63 " fill="none" filter="url(#f4ylvyktbu14i)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="22" y="1333.9219">Client</text><ellipse cx="45" cy="1346.875" fill="#FEFECE" filter="url(#f4ylvyktbu14i)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M45,1354.875 L45,1381.875 M32,1362.875 L58,1362.875 M45,1381.875 L32,1396.875 M45,1381.875 L58,1396.875 " fill="none" filter="url(#f4ylvyktbu14i)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="117" x="212.5" y="83.5352">Get Accounts List</text><path d="M253.5,42 L253.5,66 M253.5,54 L270.5,54 " fill="none" filter="url(#f4ylvyktbu14i)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="282.5" cy="54" fill="#FEFECE" filter="url(#f4ylvyktbu14i)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="117" x="212.5" y="1333.9219">Get Accounts List</text><path d="M253.5,1340.875 L253.5,1364.875 M253.5,1352.875 L270.5,1352.875 " fill="none" filter="url(#f4ylvyktbu14i)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="282.5" cy="1352.875" fill="#FEFECE" filter="url(#f4ylvyktbu14i)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="145" x="443.5" y="83.5352">Account Microservice</text><path d="M498.5,42 L498.5,66 M498.5,54 L515.5,54 " fill="none" filter="url(#f4ylvyktbu14i)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="527.5" cy="54" fill="#FEFECE" filter="url(#f4ylvyktbu14i)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="145" x="443.5" y="1333.9219">Account Microservice</text><path d="M498.5,1340.875 L498.5,1364.875 M498.5,1352.875 L515.5,1352.875 " fill="none" filter="url(#f4ylvyktbu14i)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="527.5" cy="1352.875" fill="#FEFECE" filter="url(#f4ylvyktbu14i)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="643" y="83.5352">Cassandra</text><path d="M664,34 C664,24 682,24 682,24 C682,24 700,24 700,34 L700,60 C700,70 682,70 682,70 C682,70 664,70 664,60 L664,34 " fill="#FEFECE" filter="url(#f4ylvyktbu14i)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M664,34 C664,44 682,44 682,44 C682,44 700,44 700,34 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="643" y="1333.9219">Cassandra</text><path d="M664,1346.875 C664,1336.875 682,1336.875 682,1336.875 C682,1336.875 700,1336.875 700,1346.875 L700,1372.875 C700,1382.875 682,1382.875 682,1382.875 C682,1382.875 664,1382.875 664,1372.875 L664,1346.875 " fill="#FEFECE" filter="url(#f4ylvyktbu14i)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M664,1346.875 C664,1356.875 682,1356.875 682,1356.875 C682,1356.875 700,1356.875 700,1346.875 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#f4ylvyktbu14i)" height="876.6875" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="269" y="96.4883"/><rect fill="#FFFFFF" filter="url(#f4ylvyktbu14i)" height="96.6211" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="514" y="414.791"/><polygon fill="#A80036" points="257,113.6211,267,117.6211,257,121.6211,261,117.6211" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="45" x2="263" y1="117.6211" y2="117.6211"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="52" y="112.5552">GETÂ /v1/customer/accounts</text><path d="M50,130.6211 L50,293.6211 L263,293.6211 L263,140.6211 L253,130.6211 L50,130.6211 " fill="#FBFB77" filter="url(#f4ylvyktbu14i)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M253,130.6211 L253,140.6211 L263,140.6211 L253,130.6211 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="56" y="148.1895">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="72" y="163.5">"guid": "...",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="72" y="178.8105">"accounts": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="88" y="194.1211">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="104" y="209.4316">"accountNumber": "...",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="104" y="224.7422">"phoneNumber": "..."</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="88" y="240.0527">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="72" y="255.3633">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="72" y="270.6738">"scopes": [ "...", "..." ]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="56" y="285.9844">}</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="279" x2="321" y1="324.0371" y2="324.0371"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="321" x2="321" y1="324.0371" y2="337.0371"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="280" x2="321" y1="337.0371" y2="337.0371"/><polygon fill="#A80036" points="290,333.0371,280,337.0371,290,341.0371,286,337.0371" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="286" y="319.2949">Check authorization</text><path d="M167,352.0371 L241,352.0371 L241,359.0371 L231,369.0371 L167,369.0371 L167,352.0371 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="565.8281" style="stroke: #000000; stroke-width: 2.0;" width="574" x="167" y="352.0371"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29" x="182" y="365.6055">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="151" x="256" y="364.6719">[for each account in token]</text><path d="M177,376.3477 L245,376.3477 L245,383.3477 L235,393.3477 L177,393.3477 L177,376.3477 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="534.5176" style="stroke: #000000; stroke-width: 2.0;" width="554" x="177" y="376.3477"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="192" y="389.916">par</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="512" x2="502" y1="414.791" y2="410.791"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="512" x2="502" y1="414.791" y2="418.791"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="279" x2="513" y1="414.791" y2="414.791"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="286" y="409.7251">GETÂ /v1/account/{accountId}</text><path d="M284,427.791 L284,452.791 L399,452.791 L399,437.791 L389,427.791 L284,427.791 " fill="#FBFB77" filter="url(#f4ylvyktbu14i)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M389,427.791 L389,437.791 L399,437.791 L389,427.791 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="290" y="445.0356">apiKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="342" y="445.3594">header</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="680" x2="670" y1="483.4121" y2="479.4121"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="680" x2="670" y1="483.4121" y2="487.4121"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="524" x2="681" y1="483.4121" y2="483.4121"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="531" y="478.6699">Fetch account details</text><polygon fill="#A80036" points="535,493.4121,525,497.4121,535,501.4121,531,497.4121" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="529" x2="681" y1="497.4121" y2="497.4121"/><polygon fill="#A80036" points="290,507.4121,280,511.4121,290,515.4121,286,511.4121" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="284" x2="518" y1="511.4121" y2="511.4121"/><path d="M187,524.4121 L187,901.4121 L510,901.4121 L510,534.4121 L500,524.4121 L187,524.4121 " fill="#FBFB77" filter="url(#f4ylvyktbu14i)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M500,524.4121 L500,534.4121 L510,534.4121 L500,524.4121 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="193" y="541.9805">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="209" y="557.291">"accountsDetails": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="225" y="572.6016">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="204" x="241" y="587.9121">"accountNumber": "694762329",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="241" y="603.2227">"accountType": "Consumer",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="241" y="618.5332">"accountSubType": "Regular",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="241" y="633.8438">"activeFrom": null,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="241" y="649.1543">"consolidatedAccountInd": false,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="241" y="664.4648">"accountStatus": "OPEN",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="241" y="679.7754">"reasonCode": null,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="241" y="695.0859">"fraudInd": null,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="241" y="710.3965">"lineOfBussiness": "WL",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="241" y="725.707">"accountEventLastTs": null,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="241" y="741.0176">"franchiseCode": "Rogers",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="254" x="241" y="756.3281">"customerBillingProfileId": "804737093",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="241" y="771.6387">"consolidatedAccountNumber": null,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="241" y="786.9492">"IDVInd": null,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="241" y="802.2598">"ecId": "29517889"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="225" y="817.5703">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="209" y="832.8809">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="209" y="848.1914">"billingAddress": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="225" y="863.502">...</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="209" y="878.8125">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="193" y="894.123">}</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="279" x2="321" y1="946.1758" y2="946.1758"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="321" x2="321" y1="946.1758" y2="959.1758"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="280" x2="321" y1="959.1758" y2="959.1758"/><polygon fill="#A80036" points="290,955.1758,280,959.1758,290,963.1758,286,959.1758" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="286" y="941.4336">Combine and Map</text><polygon fill="#A80036" points="56,969.1758,46,973.1758,56,977.1758,52,973.1758" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="50" x2="273" y1="973.1758" y2="973.1758"/><path d="M8,986.1758 L8,1302.1758 L265,1302.1758 L265,996.1758 L255,986.1758 L8,986.1758 " fill="#FBFB77" filter="url(#f4ylvyktbu14i)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M255,986.1758 L255,996.1758 L265,996.1758 L255,986.1758 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="14" y="1003.7441">[</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="30" y="1019.0547">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="204" x="46" y="1034.3652">"accountNumber": "694762329",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="46" y="1049.6758">"name": "My Account",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="46" y="1064.9863">"state": "Active",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="46" y="1080.2969">"type": "Consumer",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="53" x="46" y="1095.6074">"links": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="62" y="1110.918">...</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="46" y="1126.2285">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="30" y="1141.5391">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="30" y="1156.8496">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="204" x="46" y="1172.1602">"accountNumber": "694762330",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="46" y="1187.4707">"name": "My Wife's Account",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="46" y="1202.7813">"state": "Active",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="46" y="1218.0918">"type": "Consumer",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="53" x="46" y="1233.4023">"links": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="62" y="1248.7129">...</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="46" y="1264.0234">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="30" y="1279.334">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="14" y="1294.6445">]</text><!--
@startuml

actor Client

box "Account API" #LightBlue
    boundary "Get Accounts List" as AccountsList
end box

box "Microservice" #LightGreen
    boundary "Account Microservice" as Account
    database Cassandra
end box

activate AccountsList

Client -> AccountsList: ""GET /v1/customer/accounts""
note right of Client
{
    "guid": "...",
    "accounts": [
        {
            "accountNumber": "...",
            "phoneNumber": "..."
        }
    ],
    "scopes": [ "...", "..." ]
}
end note

AccountsList -> AccountsList: Check authorization

loop for each account in token

par

AccountsList ->> Account: ""GET /v1/account/{accountId}""

activate Account
note right of AccountsList : ""apiKey"" header

Account ->> Cassandra: Fetch account details
Account <- - Cassandra

AccountsList <- - Account
note left of Account
{
    "accountsDetails": [
        {
            "accountNumber": "694762329",
            "accountType": "Consumer",
            "accountSubType": "Regular",
            "activeFrom": null,
            "consolidatedAccountInd": false,
            "accountStatus": "OPEN",
            "reasonCode": null,
            "fraudInd": null,
            "lineOfBussiness": "WL",
            "accountEventLastTs": null,
            "franchiseCode": "Rogers",
            "customerBillingProfileId": "804737093",
            "consolidatedAccountNumber": null,
            "IDVInd": null,
            "ecId": "29517889"
        }
    ],
    "billingAddress": {
        ...
    }
}
end note

deactivate Account

end

end

AccountsList -> AccountsList: Combine and Map

Client <- - AccountsList
note left of AccountsList
[
    {
        "accountNumber": "694762329",
        "name": "My Account",
        "state": "Active",
        "type": "Consumer",
        "links": [
            ...
        ]
    },
    {
        "accountNumber": "694762330",
        "name": "My Wife's Account",
        "state": "Active",
        "type": "Consumer",
        "links": [
            ...
        ]
    }
]
end note

deactivate AccountsList

@enduml

PlantUML version 1.2018.13(Mon Nov 26 12:11:51 EST 2018)
(APACHE source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 11.0.2+9-LTS
Operating System: Mac OS X
OS Version: 10.13.6
Default Encoding: UTF-8
Language: en
Country: CA
--></g></svg>